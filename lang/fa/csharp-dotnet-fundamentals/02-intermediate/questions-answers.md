## Q1. کمی دربارهٔ حالت‌های مختلف COMJIT / کامپایل در .NET و تغییرات آن‌ها توضیح دهید.

**Question:**  
حالت‌های مختلف کامپایل JIT در .NET (مثلاً Pre-JIT، Tiered JIT، ReadyToRun) چیستند؟ چگونه در طول زمان تکامل یافته‌اند و چه مزایا یا تغییراتی ایجاد شده‌اند؟

**Answer:**  
در .NET استراتژی‌های کامپایل متفاوتی وجود دارد که برای تعادل بین **زمان شروع برنامه (startup)** و **عملکرد درازمدت** طراحی شده‌اند:

- **Pre-JIT / کامپایل AOT / ReadyToRun**: تبدیل IL به کد بومی پیش از اجرا تا بخش زیادی از کار JIT در زمان اجرا کاهش یابد. باعث بهبود زمان شروع می‌شود اما ممکن است کدِ تولیدی بهینه‌ترین نباشد. :contentReference[oaicite:6]{index=6}  
- **کامپایل JIT چندمرحله‌ای (Tiered JIT)** — از .NET Core 3.0 به بعد فعال است:  
  1. **Tier 0** (Quick JIT): کامپایل سریع با کمترین بهینه‌سازی برای شروع سریع‌تر. :contentReference[oaicite:7]{index=7}  
  2. **Tier 1** (JIT بهینه‌تر): اگر متدی زیاد استفاده شود، در پس‌زمینه بازکامپایل با بهینه‌سازی کامل انجام می‌شود. :contentReference[oaicite:8]{index=8}  
- **تعامل ReadyToRun با Tiered JIT**: ممکن است کدی از ReadyToRun شروع شود و بعد توسط Tiered JIT دوباره کامپایل شود تا عملکرد بهتری داشته باشد. :contentReference[oaicite:9]{index=9}  
- **تنظیمات Quick JIT**: برای متدهایی که شامل لوپ نیستند، Quick JIT با بهینه‌سازی پایین‌تر می‌تواند سریع‌تر کد تولید کند؛ اما ممکن است عملکرد کمتر بهینه داشته باشد. :contentReference[oaicite:10]{index=10}  

**مزایا / تغییرات در طول زمان**  
- زمان شروع برنامه بهبود یافته است چون کارهای سنگین JIT در ابتدا تخفیف داده می‌شوند.  
- متدهای پرتکرار بعداً بهینه می‌شوند تا هم سرعت بالا و هم عملکرد خوب ترکیب شود.  
- کد پیش‌کامپایل‌شده (ReadyToRun) هزینه JIT را کاهش می‌دهد، ولی ممکن است برای سخت‌افزار خاص، بهینه نباشد.  
- انعطاف‌پذیری بیشتر: در .NET امکان تنظیم این رفتارها (فعال/غیرفعال کردن Tiered، Quick JIT و غیره) از طریق تنظیمات زمان اجرا وجود دارد. :contentReference[oaicite:11]{index=11}  



## Q2. AOT در .NET چیست؟

**Question:**  
مفهوم **AOT (Ahead-Of-Time compilation)** در .NET چیست و چه تفاوتی با JIT دارد؟

**Answer:**  
- **AOT** یعنی تبدیل کد **IL** به کد بومی (Native) در زمان **ساخت یا انتشار (build/publish)**، نه در زمان اجرا.  
- در .NET این کار برای بهبود **سرعت شروع برنامه**، کاهش **هزینهٔ زمان اجرا** و سازگاری با محیط‌هایی که JIT اجازه ندارد (مثل iOS یا Blazor WebAssembly) استفاده می‌شود.  

**AOT در .NET:**  
- **ReadyToRun (R2R):** حالت AOT جزئی → بخش زیادی از IL در زمان انتشار به بومی تبدیل می‌شود، اما در صورت نیاز JIT هم کار می‌کند.  
- **Native AOT (از .NET 7+):** کل برنامه به کد بومی کامپایل می‌شود → در زمان اجرا JIT وجود ندارد.  
- **Mono AOT:** در Xamarin/MAUI و Blazor WebAssembly استفاده می‌شود → IL به WASM یا کد بومی مخصوص پلتفرم تبدیل می‌شود.  

**مزایا:**  
- شروع سریع‌تر برنامه (بدون JIT اولیه).  
- اجرا در محیط‌های محدود (مثل موبایل و مرورگر).  
- گاهی مصرف حافظه کمتر.  

**معایب:**  
- اندازهٔ باینری بزرگ‌تر.  
- بهینه‌سازی‌های پویا مثل Tiered JIT کمتر می‌شود.  
- زمان ساخت/انتشار طولانی‌تر.  

**مثال — انتشار با ReadyToRun:**
```bash
dotnet publish -c Release -r win-x64 -p:PublishReadyToRun=true
//مثال — انتشار با Native AOT (از .NET 7):
dotnet publish -c Release -r win-x64 -p:PublishAot=true
```